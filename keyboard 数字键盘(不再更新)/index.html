<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="renderer" content="webkit">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,initial-scale=1.0,user-scalable=no,width=device-width">
<meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
<title>数字键盘控件</title>
<link rel="stylesheet" type="text/css" href="style/plugins-number.css"><!--数字键盘控件样式-->
<style>
*{box-sizing:border-box;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;-o-box-sizing:border-box;-ms-box-sizing:border-box;}
html,body{width:100%;margin:0 auto;font-size:14px;}
h1,h2{text-align:center;}
h1{font-size:20px;color:#f60;}
h2{font-size:18px;color:#0ae;}
.blue{color:#0ae;}
.red{color:#f60;font-weight:bold;}
.r-unit{position:absolute;right:15px;top:8px;font-size:12px;color:gray;}


.content{width:100%;margin:0 auto;}
.panel-demo{width:98%;margin:0 auto 15px auto;padding:20px;border:1px solid #aaa;border-radius:3px;}
.demo-title{margin:25px auto 15px auto;padding-bottom:8px;border-bottom:1px dashed #ddd;font-weight:bold;font-size:18px;text-align:center;}
.demo-tips{margin:5px auto;font-size:12px;color:#e69617;}
.demo-one{position:relative;margin-bottom:15px;}
.demo-one>span{display:inline-block;min-width:100px;}
.demo-one>input{margin-left:8px;width:250px;height:30px;line-height:30px;padding:0 8px;border:1px solid #ddd;border-radius:4px;}

.icon-phone{display:inline-block;width:18px;height:18px;background-image:url('img/icon_tel_gray_1.png');background-size:100% auto;background-positon:50% 50%;background-repeat:no-repeat;}
.icon-phone.hover{background-image:url('img/icon_tel_blue_1.png');}

@media screen and (max-width:413px){
	.demo-one>input{width:200px;}
}


</style>
</head>
<body>
<script type="text/javascript" src="style/jquery-1.8.0.min.js"></script>
<script type="text/javascript" src="style/jquery.calculate.js"></script><!--乘法小插件-->
<script type="text/javascript" src="style/jquery.number.js"></script><!--数字键盘控件-->
<div class="content">
	<h1>数字键盘控件自适应PC、移动端）Demo</h1>
	
	<section class="panel-demo">
		<div class="demo-one" style="position: relative;">
			<span>室内面积</span><input type="text" class="area" id="snmj" readonly="" placeholder="最小值50，最大值300" onfocus="this.placeholder=&#39;&#39;" onblur="this.placeholder=&#39;最小值50，最大值300&#39;"><em class="r-unit">m²</em>
		</div><!--demo-one-->
		<div class="demo-one" style="position: relative;">
			<span>土地面积</span><input type="text" class="area" id="tdmj" readonly="" placeholder="最小值20，最大值50" onfocus="this.placeholder=&#39;&#39;" onblur="this.placeholder=&#39;最小值20，最大值50&#39;"><em class="r-unit">m²</em>
		</div><!--demo-one--> 
    <div class="demo-one" style="position: relative;">
			<span>手机号码</span><input type="text" class="area click-tel" readonly="" placeholder="电话号码有效图标将高亮" onblur="this.placeholder=&#39;电话号码有效图标将高亮&#39;" onfocus="this.placeholder=&#39;&#39;"><a class="icon icon-phone r-unit"></a>
		</div><!--demo-one-->
	</section><!--/panel-demo-->
	
	<section class="panel-demo">
  	<h2>计算总价</h2>
		<div class="demo-one" style="position: relative;">
			<span>建筑面积</span><input type="text" class="area" id="click-jzmj" value="80.4" readonly=""><em class="r-unit">m²</em>
		</div><!--demo-one-->
		<div class="demo-one" style="position: relative;">
			<span>储藏间面积</span><input type="text" class="area" id="click-ccjmj" value="20.5" readonly=""><em class="r-unit">m²</em>
		</div><!--demo-one-->
		
		<div class="demo-title">市场价值</div>
		<div class="demo-one" style="position: relative;">
			<span>单价</span><input type="text" class="area blue" id="input-market-unit-price" value="8600.2" readonly=""><em class="r-unit">元/m²</em>
		</div><!--demo-one-->
		<div class="demo-one" style="position: relative;">
			<span>总价</span><input type="text" class="area red" id="input-market-total-price" value="77.96" readonly=""><em class="r-unit">万元</em>
		</div><!--demo-one-->
		<div class="demo-tips">计算方法：总价 = 单价*建筑面积 + 单价*(储藏间面积/2)</div><!--/demo-tips-->
		
		<div class="demo-title">抵押净值</div>
		<div class="demo-one" style="position: relative;">
			<span>单价</span><input type="text" class="area blue" id="input-pawn-unit-price" value="7800.8" readonly=""><em class="r-unit">元/m²</em>
		</div><!--demo-one-->
		<div class="demo-one" style="position: relative;">
			<span>总价</span><input type="text" class="area red" id="input-pawn-total-price" value="70.71" readonly=""><em class="r-unit">万元</em>
		</div><!--demo-one-->
		<div class="demo-tips">计算方法：总价 = 单价*建筑面积 + 单价*(储藏间面积/2)</div><!--/demo-tips-->
		
	</section><!--/panel-demo-->
	
	<section class="panel-demo">
		<div class="demo-one" style="position: relative;">
			<span>贷款利率</span><input type="text" class="area icon-rate" id="input_loanRate" value="11%" placeholder="如5%，请输入0.05" onfocus="this.placeholder=&#39;&#39;;this.blur();" onblur="this.placeholder=&#39;如5%，请输入0.05&#39;" readonly="">
		</div><!--demo-one-->
	</section><!--/panel-demo-->

</div><!--/content-->
  
  
  
  
<script type="text/javascript">



/*+--------------------------+*/
//数字键盘电话号码检测公用函数（验证电话号码是否有效）
var keyboadCheck = {
	 checkTel:function(str){ //检验电话号码
			//..正则表达式验证
			var reg = /^0?1[3|4|5|7|8|9][0-9]\d{8}$/; //13,14,15,17,18,19开头电话号码
			var tel = $.trim(str);  //var tel = str.trim();//如果节点不存在，直接str.trim()会报错
			if(reg.test(tel)) return true;
			//if(str.trim().length==11) return true; //..只检验是否11位
			//if(str.trim().length<=12 && str.trim().length>=6) return true; //..只检验是否6-12位(含固话、手机号）//不兼容ie8
			//if($.trim(str).length<=12 && $.trim(str).length>=6) return true; //..只是否6-12位(含固话、手机号）兼容ie8及以下版本
		 },
		 checkHighlight:function(){ //电话号码图标高亮
		 	var obj = typeof(arguments[0])=='undefined' ? '' : arguments[0]; //当前电话输入框节点
			var siblings = $(obj).siblings('.icon-phone'); //拨打电话图标节点
			if(obj[0].className.indexOf('click-tel')>=0 && siblings.length>0){ //如果是电话输入框节点、且右侧有拨打电话的图标
					if(typeof(checker)!='undefined'){
						if(typeof(checker.checkTelHighlight)=='function'){ //调用通用函数来校验电话图标高亮
						 checker.checkTelHighlight(obj,siblings);
						}
					}else{ //如通用函数不存在，则调用自定义的函数
						 var tel = '';
						 if(obj[0].tagName.toLocaleLowerCase()=='input') tel = obj.val();
						 else tel = obj.text();
						 if(this.checkTel(tel)) siblings.addClass('hover').attr('href','tel:'+tel);
						 else siblings.removeClass('hover').attr('href','javascript:void(0);');	
					}
			}
		}
};

//////////////////////////////
$(function(){

	/*+----------------------------+*/
	//=====调用数字键盘控件
	$('.area').each(function(){
		$(this).fadeIn(400).checkNum({
			
			//!!!注：前台可通过 this.object 获取当前调用数字键盘的元素对象,eg1. this.object[0].id; //当前元素的ID  eg2.this.object[0].className; //当前元素class
			
			title:'宣朗专属数字键盘',
			//hasPoint:false, //是否有小数点(可缺省),默认true
			
			//..最小值最大值->针对所有调用数字键盘的元素都有效
			//minimum:10, //输入最小值(可缺省)
			//maximum:500, //输入最大值(可缺省)
			
			//..最小值最大值->只对指定元素有效  (如下表示ID='snmj'的元素输入范围介于50-300, ID='tdmj'的元素输入范围介于20-50
			minimum:[{id:'#snmj',value:50},{id:'#tdmj',value:20}], //输入最小值(可缺省)
			maximum:[{id:'#snmj',value:300},{id:'#tdmj',value:50}], //输入最大值(可缺省)
			
			
			//几个回调函数
			keyCallBack:function(){ //点击数字键盘按键时的回调函数
				countWorthFunc(this.object); 
				keyboadCheck.checkHighlight(this.object); //验证电话号码是否有效
			},
			eleCallBack:function(){ //点击元素时的回调函数(元素指调用本插件的元素)
				rate2Decimal(this.object); //利率转化成小数
			},
			closeCallBack:function(){ //关闭数字键盘时的回调函数
				decimal2Rate(this.object); //小数转化成利率
			}
		})
		
	});
	
	
	
	/*+--------------------------+*/
	/*
	* 函数：计算市场价值总价、抵押净值总价
	* 计算方法：总价 = 单价*建筑面积 + 单价*(储藏间面积/2)
	故，单价、建筑面积、储藏间面积变化时，总价也将随之变化
	*/
	function countWorthFunc(obj){
		 var $this = obj;
		 var digit = 2; //小数点保留的位数
		 var jzmj = '#click-jzmj'; //建筑面积(可能有，也可能没有）
		 var ccjmj = '#click-ccjmj'; //储藏间面积(可能有，也可能没有）
		 if($(jzmj).length>0 || $(ccjmj).length>0){
				
			//计算方法：总价 = 单价*建筑面积 + 单价*(储藏间面积/2)
			 var decimal1 = decimal2 = calculate.digit(digit); //小数位
	
			 var	e1 = '#input-market-unit-price'; //市场价值单价
			 var	r1 = '#input-market-total-price'; //市场价值总价
			 var total_jzmj1 = 0; //建筑面积计算
			 var total_ccjmj1 = 0; //储藏间计算
			 if($(jzmj).length>0) total_jzmj1 = parseFloat($(e1).val())* parseFloat($(jzmj).val());
			 if($(ccjmj).length>0)  total_ccjmj1 = parseFloat($(e1).val()) * (parseFloat($(ccjmj).val())/2);
			 var val1 = total_jzmj1 + total_ccjmj1;
			
			 
			 var	e2 = '#input-pawn-unit-price'; //抵押净值单价
			 var	r2 = '#input-pawn-total-price'; //抵押净值总价
			 var total_jzmj2 = 0; //建筑面积计算
			 var total_ccjmj2 = 0; //储藏间计算
			 if($(jzmj).length>0) total_jzmj2 = parseFloat($(e2).val()) * parseFloat($(jzmj).val());
			 if($(ccjmj).length>0)  total_ccjmj2 = parseFloat($(e2).val()) * (parseFloat($(ccjmj).val())/2);
			 var val2 = total_jzmj2 + total_ccjmj2;
	
			 //只有当点击指定元素时才计算,以免影响其它元素的
			 if($this.attr('id')==e1.replace('#',''))	calculate.result(r1,val1/10000,decimal1); //点击市场价值单价->计算结果
			 if($this.attr('id')==e2.replace('#','')) calculate.result(r2,val2/10000,decimal2); //点击抵押净值单价->计算结果
			 if($(r1).length>0&&$(r2).length>0 && ( $this.attr('id')==jzmj.replace('#','') || $this.attr('id')==ccjmj.replace('#','') ) ){ //点击建筑面积或储藏间面积->计算结果
				 calculate.result(r1,val1/10000,decimal1);
				 calculate.result(r2,val2/10000,decimal2);
			 }
		 }
	}
	
	
	
	/*+--------------------------+*/
	/*函数：利率转化成小数*/
	function rate2Decimal(obj){
		var $this = obj;
		if($this.hasClass('icon-rate')){ 
			var value = $this.val().replace('%','');
			//value = value /100;
			value = value*1000000 /100000000; //解决js小数乘法除法的bug
			if(value==0) value = '';
			var type = $this[0].tagName.toLocaleLowerCase(); //元素类型:input span div select
			if(type!='input') $this.html(value);
			else $this.val(value);
		}
	}
	
	
	/*+--------------------------+*/
	/*函数：小数转化成利率*/
	function decimal2Rate(obj){ 
		var $this = obj;
		if($this.hasClass('icon-rate') && $this.val()!=''){ 
			//var value = parseFloat($this.val())*100 + '%';
			var value = parseFloat($this.val())*1000000/10000 + '%'; //解决js小数乘法除法的bug
			var type = $this[0].tagName.toLocaleLowerCase(); //元素类型:input span div select
			if(type!='input') $this.html(value);
			else $this.val(value);
		}
	}
	
	

}); //END $(function(){})

</script>

</body></html>